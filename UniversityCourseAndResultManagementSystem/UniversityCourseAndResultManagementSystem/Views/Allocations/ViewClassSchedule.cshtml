@model UniversityCourseAndResultManagementSystem.Models.Allocation

@{
    ViewBag.Title = "Class Schedule";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>View Class Schedule</h2>


@using (Html.BeginForm())
{

    @Html.AntiForgeryToken()

    <div class="form-horizontal">

        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.DepartmentId, "Department", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("DepartmentId", null, "--Select Department--", htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.DepartmentId, "", new { @class = "text-danger" })
            </div>
        </div>

        <table class="table table-bordered table-striped" id="resultTable">
            <thead>
                <tr>
                    <th>Course Code</th>
                    <th>Name</th>
                    <th>Room No.</th>
                    <th>Day</th>
                    <th>From</th>
                    <th>To</th>
                </tr>
            </thead>
            <tbody id="classSchedule"></tbody>
        </table>

    </div>
}


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>
        $(document).ready(function () {

            $("#DepartmentId").change(function () {
                var id = $("#DepartmentId").val();
                var parameter = { deptid: id }

                $("#classSchedule").empty();

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetClassSchedule", "Allocations")',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(parameter),
                    success: function (allocatedrooms) {
                        $.each(allocatedrooms, function (key, value) {
                            
                            $("#classSchedule").append(
                                '<tr>' +
                                '<td>' + value.Course.CourseCode + '</td>' +
                                '<td>' + value.Course.CourseName + '</td>' +
                                '<td>' + value.Room.RoomNo + '</td>' +
                                '<td>' + value.Day.DayName + '</td>' +
                                '<td>' + value.FromTime + '</td>' +
                                '<td>' + value.ToTime + '</td>' +
                                '</tr>'
                            )

                         });

                    }
                });

            });
        });



    </script>
}

